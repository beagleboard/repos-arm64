#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

#U-Boot
UB_TAG=v2021.01-ti-08.00.00.004
UB_CONFIG=j721e_evm_

override_dh_strip:
	# Just disable for now...

override_dh_auto_configure:
	git clone -b $(UB_TAG) https://github.com/beagleboard/u-boot.git --depth=1
	cd ./u-boot/ ; make CROSS_COMPILE=arm-linux-gnueabihf- $(UB_CONFIG)r5_defconfig O=../r5 ; make -j2 CROSS_COMPILE=arm-linux-gnueabihf- O=../r5 ; cd ../
	cd ./u-boot/ ; make CROSS_COMPILE=aarch64-linux-gnu- $(UB_CONFIG)a72_defconfig O=../a72 ; make -j2 CROSS_COMPILE=aarch64-linux-gnu- ATF=../debian/bl31.bin TEE=../debian/tee-pager_v2.bin DM=../debian/ipc_echo_testb_mcu1_0_release_strip.xer5f O=../a72 ; cd ../

%:
	dh $@

